<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate Differential Expression Pipeline — simulateDE • powsimR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate Differential Expression Pipeline — simulateDE" />
<meta property="og:description" content="simulateDE is the main function to simulate differential expression for RNA-seq experiments.
The simulation parameters are specified with Setup.
The user now needs to specify the RNA-seq Analysis Pipeline including preprocessing, normalisation and differential testing method.
The return object contains DE test results from all simulations as well as descriptive statistics.
The error matrix calculations will be conducted with evaluateDE." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">powsimR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/powsimR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bvieth/powsimR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate Differential Expression Pipeline</h1>
    <small class="dont-index">Source: <a href='https://github.com/bvieth/powsimR/blob/master/R/Simulate.R'><code>R/Simulate.R</code></a></small>
    <div class="hidden name"><code>simulateDE.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>simulateDE is the main function to simulate differential expression for RNA-seq experiments.
The simulation parameters are specified with <code><a href='Setup.html'>Setup</a></code>.
The user now needs to specify the RNA-seq Analysis Pipeline including preprocessing, normalisation and differential testing method.
The return object contains DE test results from all simulations as well as descriptive statistics.
The error matrix calculations will be conducted with <code><a href='evaluateDE.html'>evaluateDE</a></code>.<br /></p>
    </div>

    <pre class="usage"><span class='fu'>simulateDE</span>(<span class='no'>SetupRes</span>,
<span class='kw'>Prefilter</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>Imputation</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>Normalisation</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"TMM"</span>, <span class='st'>"MR"</span>, <span class='st'>"PosCounts"</span>, <span class='st'>"UQ"</span>,
<span class='st'>"scran"</span>, <span class='st'>"Linnorm"</span>, <span class='st'>"sctransform"</span>,
<span class='st'>"SCnorm"</span>, <span class='st'>"Census"</span>, <span class='st'>"depth"</span>),
<span class='kw'>Label</span> <span class='kw'>=</span> <span class='st'>"none"</span>,
<span class='kw'>DEmethod</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"T-Test"</span>, <span class='st'>"edgeR-LRT"</span>, <span class='st'>"edgeR-QL"</span>,
<span class='st'>"edgeR-zingeR"</span>, <span class='st'>"edgeR-ZINB-WaVE"</span>,
<span class='st'>"limma-voom"</span>, <span class='st'>"limma-trend"</span>,
<span class='st'>"DESeq2"</span>, <span class='st'>"DESeq2-zingeR"</span>, <span class='st'>"DESeq2-ZINB-WaVE"</span>,
<span class='st'>"ROTS"</span>, <span class='st'>"baySeq"</span>, <span class='st'>"NOISeq"</span>, <span class='st'>"EBSeq"</span>,
<span class='st'>"MAST"</span>, <span class='st'>"BPSC"</span>, <span class='st'>"scDD"</span>, <span class='st'>"DECENT"</span>),
<span class='kw'>DEFilter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
<span class='kw'>Counts</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
<span class='kw'>NCores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>SetupRes</th>
      <td><p>This object specifies the simulation setup.
This must be the return object from <code><a href='Setup.html'>Setup</a></code>.</p></td>
    </tr>
    <tr>
      <th>Prefilter</th>
      <td><p>A character vector specifying the gene expression filtering method
to be used prior to normalisation (and possibly imputation).
Default is <code>NULL</code>, i.e. no filtering.
Please consult the Details section for available options.</p></td>
    </tr>
    <tr>
      <th>Imputation</th>
      <td><p>A character vector specifying the gene expression imputation method
to be used prior to normalisation.
Default is <code>NULL</code>, i.e. no imputation.
Please consult the Details section for available options.</p></td>
    </tr>
    <tr>
      <th>Normalisation</th>
      <td><p>Normalisation method to use.
Please consult the Details section for available options.</p></td>
    </tr>
    <tr>
      <th>Label</th>
      <td><p>A character vector to define whether information about
group labels should be used for normalisation.
This is only implemented for scran and SCnorm.
Possible options include the default <code>"none"</code>
which means that no sample group information is considered for normalisation;
<code>"known"</code> means that the simulated group labels are used and <code>"clustering"</code>
which applies an unsupervised hierarchical clustering to determine the group labels.
For details, see <code><a href='https://rdrr.io/pkg/scran/man/quickCluster.html'>quickCluster</a></code>).</p></td>
    </tr>
    <tr>
      <th>DEmethod</th>
      <td><p>A character vector specifying the DE detection method to be used.
Please consult the Details section for available options.</p></td>
    </tr>
    <tr>
      <th>DEFilter</th>
      <td><p>A logical vector indicating whether to run DE testing on
filtered and/or imputed count data.
Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>Counts</th>
      <td><p>A logical vector indicating whether the simulated count matrix is also provided as output.
Default is <code>FALSE</code> since the output can be quite large. Note that if DEFilter is <code>TRUE</code>,
then the returned count matrix will countain the filtered and/or imputed count data.</p></td>
    </tr>
    <tr>
      <th>NCores</th>
      <td><p>integer positive number of cores for parallel processing.
Default is <code>NULL</code>, i.e. 1 core.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical vector to indicate whether to show progress report of simulations.
Default is <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><strong>SimulateRes: Results of DE simulations</strong></p><dl'>
<dt>pvalue, fdr</dt><dd><p>3D array (ngenes * N * nsims) for p-values and FDR from each simulation.
Note that FDR values will be empty and the calculation will be done by <code><a href='evaluateDE.html'>evaluateDE</a></code> whenever applicable.</p></dd>
<dt>mu,disp,dropout</dt><dd><p>3D (ngenes * N * nsims) array for mean, dispersion and dropout of library size factor normalized read counts.</p></dd>
<dt>true.mu,true.disp,true.dropout</dt><dd><p>3D (ngenes * N * nsims) array for true mean, dispersion and dropout of simulated read counts.</p></dd>
<dt>true.depth,est.depth</dt><dd><p>True simulated and processed (after prefiltering and/or imputation if defined) sequencing depth per sample.</p></dd>
<dt>est.sf</dt><dd><p>Global library size factor estimates per sample.</p></dd>
<dt>est.gsf</dt><dd><p>3D array (ngenes * N * nsims) for size factor estimates. These are gene- and sample-wise estimates and only for SCnorm and Linnorm normalisation.</p></dd>
<dt>elfc,rlfc</dt><dd><p>3D array (ngenes * N * nsims) for log fold changes (LFC):
elfc is for the DE tool estimated LFC; rlfc is for the LFC estimated from the normalised read counts.</p></dd>
<dt>time.taken</dt><dd><p>The time taken given by <code><a href='https://rdrr.io/r/base/proc.time.html'>proc.time</a></code> for each simulation, given for preprocessing, normalisation, differential expression testing and moment estimation.</p></dd>

</dl><p><strong>SetupRes: Simulation specifications</strong></p><dl'>
<dt>DESetup - ... - estSpikeRes</dt><dd><p>Reiterating the simulated setup defined by <code><a href='Setup.html'>Setup</a></code>.</p></dd>
<dt>Pipeline</dt><dd><p>A list of chosen pipeline tools defined by above arguments.</p></dd>

</dl><p><strong>Counts: Simulated Count Matrices</strong></p><dl'>
<dt>Counts</dt><dd><p>List of lists object where <code>Counts[[Sample Size Setup]][[Simulation Run]]</code> containing simulated counts. Note that this will only be returned when <code>Counts</code> is <code>TRUE</code>. In addition, if <code>DEFilter</code> is <code>TRUE</code> then the filtered/imputed counts are returned.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Here you can find detailed information about preprocessing, imputation, normalisation and differential testing choices.
For recommendations concerning single cell RNA-sequencing pipelines,
we kindly refer the user to <a href='https://www.nature.com/articles/s41467-019-12266-7'>Vieth, et al (2019). A systematic evaluation of single cell RNA-seq analysis pipelines. Nature Communications, 10(1), 4667</a>.<br />
<strong>Prefiltering</strong><br /></p><dl'>
<dt>CountFilter</dt><dd><p>removes genes that have a mean expression below 0.2.</p></dd>
<dt>FreqFilter</dt><dd><p>removes genes that have more than 80 % dropouts.</p></dd>

</dl><p><strong>Imputation</strong><br /></p><dl'>
<dt>scImpute</dt><dd><p>apply the imputation as implemented in <code><a href='https://rdrr.io/pkg/scImpute/man/scimpute.html'>scimpute</a></code></p></dd>
<dt>DrImpute</dt><dd><p>apply the imputation as implemented in <code><a href='https://rdrr.io/pkg/DrImpute/man/DrImpute.html'>DrImpute</a></code>.</p></dd>
<dt>SAVER</dt><dd><p>apply the imputation as implemented in <code><a href='https://rdrr.io/pkg/SAVER/man/saver.html'>saver</a></code>.</p></dd>
<dt>scone</dt><dd><p>apply the imputation as implemented in <code><a href='https://rdrr.io/pkg/scone/man/scone.html'>scone</a></code>, defining 'house keeping genes' for the FNR model estimation as those that have less than 20 % dropouts and small variance (i.e. in the lower 20th quartile). If less than 25 genes could be identified, the genes with less than 5 % dropouts are used. If spike-in data is provided then these are used for the FNR model estimation.</p></dd>
<dt>MAGIC</dt><dd><p>apply the imputation as implemented in <code><a href='https://rdrr.io/pkg/Rmagic/man/magic.html'>magic</a></code>. Please note that the python package MAGIC needs to be installed to use this implementation.</p></dd>

</dl><p><strong>Normalisation</strong><br /></p><dl'>
<dt>TMM, UQ</dt><dd><p>employ the edgeR style normalization of weighted trimmed mean of M-values and upperquartile
as implemented in <code><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>calcNormFactors</a></code>, respectively.</p></dd>
<dt>MR, PosCounts</dt><dd><p>employ the DESeq2 style normalization of median ratio method and a modified geometric mean method
as implemented in <code><a href='https://rdrr.io/pkg/DESeq2/man/estimateSizeFactors.html'>estimateSizeFactors</a></code>, respectively.</p></dd>
<dt>scran, SCnorm</dt><dd><p>apply the deconvolution and quantile regression normalization methods developed for sparse RNA-seq data
as implemented in <code><a href='https://rdrr.io/pkg/scran/man/computeSumFactors.html'>computeSumFactors</a></code> and <code><a href='https://rdrr.io/pkg/SCnorm/man/SCnorm.html'>SCnorm</a></code>, respectively. Spike-ins can also be supplied for both methods via <code>spikeData</code>. Note, however that this means for scran that the normalisation as implemented in <code><a href='https://rdrr.io/pkg/scran/man/computeSumFactors.html'>calculateSumFactors</a></code> is also applied to genes (<code>general.use=TRUE</code>).</p></dd>
<dt>Linnorm</dt><dd><p>apply the normalization method for sparse RNA-seq data
as implemented in <code><a href='https://rdrr.io/pkg/Linnorm/man/Linnorm.Norm.html'>Linnorm.Norm</a></code>.
For <code>Linnorm</code>, the user can also supply <code>spikeData</code>.</p></dd>
<dt>sctransform</dt><dd><p>apply the normalization method developed for single-cell
UMI RNA-seq data as implemented in <code><a href='https://rdrr.io/pkg/sctransform/man/vst.html'>vst</a></code>.</p></dd>
<dt>Census</dt><dd><p>converts relative measures of TPM/FPKM values into mRNAs per cell (RPC) without the need of spike-in standards.
Census at least needs <code>Lengths</code> for single-end data and preferably <code>MeanFragLengths</code> for paired-end data.
The authors state that Census should not be used for UMI data.</p></dd>
<dt>depth</dt><dd><p>Sequencing depth normalisation.</p></dd>

</dl><p><strong>Differential testing</strong><br /></p><dl'>
<dt>T-Test</dt><dd><p>A T-Test per gene is applied using log transformed and normalized expression values (i.e. CPM or TPM).</p></dd>
<dt>limma-trend, limma-voom</dt><dd><p>apply differential testing as implemented in <code><a href='https://rdrr.io/pkg/limma/man/lmFit.html'>lmFit</a></code>
followed by <code><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>eBayes</a></code> on counts transformed by <code><a href='https://rdrr.io/pkg/limma/man/voom.html'>voom</a></code> or by applying mean-variance trend on log CPM values in <code><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>eBayes</a></code>.</p></dd>
<dt>edgeR-LRT, edgeR-QL</dt><dd><p>apply differential testing as implemented in <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code>, <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmLRT</a></code> and<code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFit</a></code>, <code><a href='https://rdrr.io/pkg/edgeR/man/glmQLFTest.html'>glmQLFTest</a></code>, respectively.</p></dd>
<dt>DESeq2</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/DESeq2/man/DESeq.html'>DESeq</a></code>.</p></dd>
<dt>ROTS</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/ROTS/man/ROTS.html'>ROTS</a></code> with 100 permutations on transformed counts (<code><a href='https://rdrr.io/pkg/limma/man/voom.html'>voom</a></code>).</p></dd>
<dt>baySeq</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/baySeq/man/getLikelihoods.html'>getLikelihoods</a></code> based on negative binomial prior estimates (<code><a href='https://rdrr.io/pkg/baySeq/man/getPriors.html'>getPriors.NB</a></code>).</p></dd>
<dt>NOISeq</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/NOISeq/man/noiseqbio.html'>noiseqbio</a></code> based on CPM values.</p></dd>
<dt>EBSeq</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/EBSeq/man/EBTest.html'>EBTest</a></code>.</p></dd>
<dt>MAST</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/MAST/man/zlm.html'>zlm</a></code> for zero-inflated model fitting followed by <code><a href='https://rdrr.io/pkg/MAST/man/lrTest.html'>lrTest</a></code> on log CPM values.</p></dd>
<dt>BPSC</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/BPSC/man/BPglm.html'>BPglm</a></code> on CPM values.</p></dd>
<dt>scDD</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/scDD/man/scDD.html'>scDD</a></code> on CPM values.</p></dd>
<dt>DECENT</dt><dd><p>applies differential testing as implemented in <code><a href='https://rdrr.io/pkg/DECENT/man/decent.html'>decent</a></code>.</p></dd>
<dt>edgeR-zingeR, DESeq2-zingeR</dt><dd><p>In a first step, the posterior probabilities of the zero-inflated negative binomial component are estimated (see <code><a href='https://rdrr.io/pkg/zingeR/man/zeroWeightsLS.html'>zeroWeightsLS</a></code>) and used to define a weight matrix for dispersion estimation in <code><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></code>. For the edgeR approach, the generalized model as implemented in <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code> is fitted. This is followed by an adapted LRT for differential testing to account for the weighting (see <code><a href='https://rdrr.io/pkg/zingeR/man/glmWeightedF.html'>glmWeightedF</a></code>). For DESeq2, the generalized linear model coefficients are estimated using <code><a href='https://rdrr.io/pkg/DESeq2/man/nbinomWaldTest.html'>nbinomWaldTest</a></code> and the weighting is done by setting the degrees of freedom for the T distribution.</p></dd>
<dt>edgeR-ZINB-WaVE, DESeq2-ZINB-WaVE</dt><dd><p>In a first step, a zero-inflated negative binomial regression model  is fitted (see <code><a href='https://rdrr.io/pkg/zinbwave/man/zinbFit.html'>zinbFit</a></code>) to estimate observational weights (see <code><a href='https://rdrr.io/pkg/zinbwave/man/computeObservationalWeights.html'>computeObservationalWeights</a></code>) used for dispersion estimation in <code><a href='https://rdrr.io/pkg/edgeR/man/estimateDisp.html'>estimateDisp</a></code>. For the edgeR approach, the generalized model as implemented in <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code> is fitted. This is followed by an adapted LRT for differential testing to account for the weighting (see <code><a href='https://rdrr.io/pkg/zinbwave/man/glmWeightedF.html'>glmWeightedF</a></code>). For DESeq2, the generalized linear model coefficients are estimated using <code><a href='https://rdrr.io/pkg/DESeq2/man/nbinomWaldTest.html'>nbinomWaldTest</a></code> and the weighting is done by setting the degrees of freedom for the T distribution.</p></dd>

</dl>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='estimateParam.html'>estimateParam</a></code> and <code><a href='estimateSpike.html'>estimateSpike</a></code>,  for parameter specifications;<br />
 <code><a href='Setup.html'>Setup</a></code> for simulation setup;<br />
 <code><a href='evaluateDE.html'>evaluateDE</a></code>, <code><a href='evaluateROC.html'>evaluateROC</a></code> and <code><a href='evaluateSim.html'>evaluateSim</a></code> for evaluation of simulation results.</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># estimate gene parameters</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"SmartSeq2_Gene_Read_Counts"</span>)
<span class='no'>Batches</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>Batch</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/strsplit.html'>strsplit</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>SmartSeq2_Gene_Read_Counts</span>),
                                    <span class='st'>"_"</span>), <span class='st'>"[["</span>, <span class='fl'>1</span>),
                     <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='no'>F</span>,
                     <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>SmartSeq2_Gene_Read_Counts</span>))
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"GeneLengths_mm10"</span>)
<span class='no'>estparam_gene</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='estimateParam.html'>estimateParam</a></span>(<span class='kw'>countData</span> <span class='kw'>=</span> <span class='no'>SmartSeq2_Gene_Read_Counts</span>,
                               <span class='kw'>readData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                              <span class='kw'>batchData</span> <span class='kw'>=</span> <span class='no'>Batches</span>,
                               <span class='kw'>spikeData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>spikeInfo</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                               <span class='kw'>Lengths</span> <span class='kw'>=</span> <span class='no'>GeneLengths_mm10</span>, <span class='kw'>MeanFragLengths</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                               <span class='kw'>RNAseq</span> <span class='kw'>=</span> <span class='st'>'singlecell'</span>, <span class='kw'>Protocol</span> <span class='kw'>=</span> <span class='st'>'Read'</span>,
                               <span class='kw'>Distribution</span> <span class='kw'>=</span> <span class='st'>'ZINB'</span>, <span class='kw'>Normalisation</span> <span class='kw'>=</span> <span class='st'>"scran"</span>,
                               <span class='kw'>GeneFilter</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>SampleFilter</span> <span class='kw'>=</span> <span class='fl'>3</span>,
                               <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='fl'>1.96</span>, <span class='kw'>NCores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># estimate spike parameters</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"SmartSeq2_SpikeIns_Read_Counts"</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"SmartSeq2_SpikeInfo"</span>)
<span class='no'>Batches</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>Batch</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/strsplit.html'>strsplit</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>SmartSeq2_SpikeIns_Read_Counts</span>),
                                    <span class='st'>"_"</span>), <span class='st'>"[["</span>, <span class='fl'>1</span>),
                     <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='no'>F</span>,
                     <span class='kw'>row.names</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>SmartSeq2_SpikeIns_Read_Counts</span>))
<span class='no'>estparam_spike</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='estimateSpike.html'>estimateSpike</a></span>(<span class='kw'>spikeData</span> <span class='kw'>=</span> <span class='no'>SmartSeq2_SpikeIns_Read_Counts</span>,
                                <span class='kw'>spikeInfo</span> <span class='kw'>=</span> <span class='no'>SmartSeq2_SpikeInfo</span>,
                                <span class='kw'>MeanFragLength</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                                <span class='kw'>batchData</span> <span class='kw'>=</span> <span class='no'>Batches</span>,
                                <span class='kw'>Normalisation</span> <span class='kw'>=</span> <span class='st'>'depth'</span>)
<span class='co'># define log fold change</span>
<span class='no'>p.lfc</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>,<span class='fl'>1</span>), <span class='kw'>size</span><span class='kw'>=</span><span class='no'>x</span>,<span class='kw'>replace</span><span class='kw'>=</span><span class='no'>T</span>)*<span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span>(<span class='no'>x</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='co'># set up simulations</span>
<span class='no'>setupres</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Setup.html'>Setup</a></span>(<span class='kw'>ngenes</span> <span class='kw'>=</span> <span class='fl'>10000</span>, <span class='kw'>nsims</span> <span class='kw'>=</span> <span class='fl'>10</span>,
                  <span class='kw'>p.DE</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>pLFC</span> <span class='kw'>=</span> <span class='no'>p.lfc</span>,
                  <span class='kw'>n1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>20</span>,<span class='fl'>50</span>,<span class='fl'>100</span>), <span class='kw'>n2</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>30</span>,<span class='fl'>60</span>,<span class='fl'>120</span>),
                  <span class='kw'>Thinning</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>0.9</span>,<span class='fl'>0.8</span>), <span class='kw'>LibSize</span> <span class='kw'>=</span> <span class='st'>'given'</span>,
                  <span class='kw'>estParamRes</span> <span class='kw'>=</span> <span class='no'>estparam_gene</span>,
                  <span class='kw'>estSpikeRes</span> <span class='kw'>=</span> <span class='no'>estparam_spike</span>,
                  <span class='kw'>DropGenes</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                  <span class='kw'>sim.seed</span> <span class='kw'>=</span> <span class='fl'>52679</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># run simulation</span>
<span class='no'>simres</span> <span class='kw'>&lt;-</span> <span class='fu'>simulateDE</span>(<span class='kw'>SetupRes</span> <span class='kw'>=</span> <span class='no'>setupres</span>,
                     <span class='kw'>Prefilter</span> <span class='kw'>=</span> <span class='st'>"FreqFilter"</span>, <span class='kw'>Imputation</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                     <span class='kw'>Normalisation</span> <span class='kw'>=</span> <span class='st'>'scran'</span>, <span class='kw'>Label</span> <span class='kw'>=</span> <span class='st'>'none'</span>,
                     <span class='kw'>DEmethod</span> <span class='kw'>=</span> <span class='st'>"limma-trend"</span>, <span class='kw'>DEFilter</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                     <span class='kw'>NCores</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># quick evaluation</span>
<span class='no'>evalderes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='evaluateDE.html'>evaluateDE</a></span>(<span class='kw'>simRes</span> <span class='kw'>=</span> <span class='no'>simres</span>)
<span class='co'># plot evaluation</span>
<span class='fu'><a href='plotEvalDE.html'>plotEvalDE</a></span>(<span class='kw'>evalRes</span> <span class='kw'>=</span> <span class='no'>evalderes</span>, <span class='kw'>rate</span> <span class='kw'>=</span> <span class='st'>"marginal"</span>,
           <span class='kw'>quick</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>Annot</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Beate Vieth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


