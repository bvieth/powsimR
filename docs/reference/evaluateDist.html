<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Model Diagnostics for RNAseq Data — evaluateDist • powsimR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Model Diagnostics for RNAseq Data — evaluateDist" />
<meta property="og:description" content="With this function, the user can determine goodness of fit for each gene." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">powsimR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/powsimR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bvieth/powsimR/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Model Diagnostics for RNAseq Data</h1>
    <small class="dont-index">Source: <a href='https://github.com/bvieth/powsimR/blob/master/R/Evaluate.R'><code>R/Evaluate.R</code></a></small>
    <div class="hidden name"><code>evaluateDist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>With this function, the user can determine goodness of fit for each gene.</p>
    </div>

    <pre class="usage"><span class='fu'>evaluateDist</span>(<span class='no'>countData</span>, <span class='kw'>batchData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>spikeData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>spikeInfo</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>Lengths</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>MeanFragLengths</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
<span class='kw'>RNAseq</span> <span class='kw'>=</span> <span class='st'>"singlecell"</span>, <span class='no'>Protocol</span>,
<span class='no'>Normalisation</span>,
<span class='kw'>GeneFilter</span> <span class='kw'>=</span> <span class='fl'>0.25</span>, <span class='kw'>SampleFilter</span> <span class='kw'>=</span> <span class='fl'>3</span>,
<span class='kw'>FracGenes</span> <span class='kw'>=</span> <span class='fl'>1</span>,
<span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>countData</th>
      <td><p>is a count matrix (row=gene, column=sample).
Please provide the measurements of one group only, e.g. the control group.</p></td>
    </tr>
    <tr>
      <th>batchData</th>
      <td><p>is a <code>data.frame</code> for batch annotation.
Rows correspond to samples. The first column should contain the batches, e.g. 'a', 'b', 'c', etc..
This is only used for the normalisation.</p></td>
    </tr>
    <tr>
      <th>spikeData</th>
      <td><p>is a count <code>matrix</code>.
Rows correspond to spike-ins, columns to samples.
The order of columns should be the same as in the <code>countData</code>.
This is only needed for spike-in aware normalisation methods ('MR', 'Linnorm', 'scran', 'SCnorm', 'bayNorm', 'Census'),
see details section of <code><a href='estimateParam.html'>estimateParam</a></code>.</p></td>
    </tr>
    <tr>
      <th>spikeInfo</th>
      <td><p>is a molecule count <code>matrix</code> of spike-ins.
Rows correspond to spike-ins. The order of rows should be the same as in the <code>spikeData</code>.
The column names should be 'SpikeID' and 'SpikeInput' for molecule counts of spike-ins.
This is only needed for spike-in aware normalisation methods ('MR', 'Linnorm', 'scran', 'SCnorm', 'bayNorm', 'Census'),
see details section of <code><a href='estimateParam.html'>estimateParam</a></code>.</p></td>
    </tr>
    <tr>
      <th>Lengths</th>
      <td><p>is a numeric vector of transcript lengths with the same length and order as the rows in countData.
This variable is only needed for internal gene length corrections (TPM), see details section of <code><a href='estimateParam.html'>estimateParam</a></code>.</p></td>
    </tr>
    <tr>
      <th>MeanFragLengths</th>
      <td><p>is a numeric vector of mean fragment lengths with the same length as columns in countData.
This variable is only needed for internal gene length corrections (TPM), see details section of <code><a href='estimateParam.html'>estimateParam</a></code>.</p></td>
    </tr>
    <tr>
      <th>RNAseq</th>
      <td><p>is a character value: "bulk" or "singlecell". We recommended to use this evaluaiton for single cells only.</p></td>
    </tr>
    <tr>
      <th>Protocol</th>
      <td><p>is a character value defining the type of counts given in <code>countData</code>.
Options are "UMI" (e.g. 10X Genomics, CEL-seq2) or "Read" (e.g. Smart-seq2).</p></td>
    </tr>
    <tr>
      <th>Normalisation</th>
      <td><p>is a character value: 'TMM', 'MR', 'PosCounts', 'UQ', 'scran', 'Linnorm',
'SCnorm', 'Census', 'depth', 'none'.
For more information, please consult the details section of <code><a href='estimateParam.html'>estimateParam</a></code>.</p></td>
    </tr>
    <tr>
      <th>GeneFilter</th>
      <td><p>is a numeric vector indicating the minimal proportion of nonzero expression values
for a gene across all samples to be considered expressed and used for estimating normalisation size factors.
The default is <code>0.25</code>, i.e. at least 25% of the expression values per gene need to be nonzero.</p></td>
    </tr>
    <tr>
      <th>SampleFilter</th>
      <td><p>is a numeric vector indicating the minimal number of MADs (median absolute deviation)
away from the median number of features detected as well as sequencing depth across all samples
so that outlying samples are removed prior to normalisation.
The default is <code>5</code>, i.e. at least 5 MADs away from the median.
Choose higher values if you wsant to filter out less samples.
This parameter is particularly important for single cells to ensure reliable parameter estimation.
For more information, please consult <code><a href='https://rdrr.io/pkg/scater/man/isOutlier.html'>isOutlier</a></code>.</p></td>
    </tr>
    <tr>
      <th>FracGenes</th>
      <td><p>The fraction of genes to calculate goodness of fit statistics, default is 1, i.e. for all genes.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical value to indicate whether to print function information.
Default is <code>TRUE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>List object with the results of goodness of fit and estimated parameters:</p>
<dt>edgeR</dt><dd><p>Goodness-of-fit statistic, degrees of freedom and associated p-value using the deviance and residual degrees of freedom from <code><a href='https://rdrr.io/pkg/edgeR/man/glmfit.html'>glmFit</a></code>. Furthermore, the AIC of the edgeR model fit using the residuals of <code><a href='https://rdrr.io/pkg/edgeR/man/zscoreNBinom.html'>zscoreNBinom</a></code>.</p></dd>
<dt>GOF</dt><dd><p>The fitting results per distribution, including loglikelihood, goodness-of-fit statistics, AIC and predicted number of zeroes. The following distributions were considered: Poisson, negative binomial, zero-inflated poisson and negative binomial following the 'standard' (i.e. <code><a href='https://rdrr.io/r/stats/glm.html'>glm</a></code>, <code><a href='https://rdrr.io/pkg/MASS/man/glm.nb.html'>glm.nb</a></code> and <code><a href='https://rdrr.io/pkg/pscl/man/zeroinfl.html'>zeroinfl</a></code> implementation) and fitdist approach (see <code><a href='https://rdrr.io/pkg/fitdistrplus/man/fitdist.html'>fitdist</a></code>) and Beta-Poisson following Marioni or Hemberg parameterisation. Furthermore, model fit comparison by LRT for nested and Vuong Test for non-nested models.</p></dd>
<dt>Estimates</dt><dd><p>The estimated parameters of distribution fitting.</p></dd>
<dt>ObservedZeros</dt><dd><p>The number of zeroes and dropout rate per gene.</p></dd>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## using example data set, but run it for fraction of genes</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='st'>"CELseq2_Gene_UMI_Counts"</span>)
<span class='no'>evalDistRes</span> <span class='kw'>&lt;-</span> <span class='fu'>evaluateDist</span>(<span class='kw'>countData</span> <span class='kw'>=</span> <span class='no'>CELseq2_Gene_UMI_Counts</span>, <span class='kw'>batchData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                            <span class='kw'>spikeData</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>spikeInfo</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                            <span class='kw'>Lengths</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>MeanFragLengths</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
                            <span class='kw'>RNAseq</span> <span class='kw'>=</span> <span class='st'>"singlecell"</span>, <span class='kw'>Protocol</span> <span class='kw'>=</span> <span class='st'>"UMI"</span>,
                            <span class='kw'>Normalisation</span> <span class='kw'>=</span> <span class='st'>"scran"</span>,
                            <span class='kw'>GeneFilter</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>SampleFilter</span> <span class='kw'>=</span> <span class='fl'>3</span>,
                            <span class='kw'>FracGenes</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
                            <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'><a href='plotEvalDist.html'>plotEvalDist</a></span>(<span class='no'>evalDistRes</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Beate Vieth.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


